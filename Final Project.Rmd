---
title: "Final Project"
author: John Banta (Project Coordinator), Kelsey Mclnturff, Luping Wang, and Brenna
  Walters
date: "11/18/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Sections {.tabset}



### Data Cleaning



### Question 1

#### During what time period has the highest accident rate?

### Question 2

#### What is the relationship between the number of victims and the driver blood alcohol concentration?

### Question 3

#### What type of vehicle has the highest rate of collision? How is the vehicle type related to the number of victims?

##### Data Cleaning

For my data cleaning, I had to change the column names because there were the same name of columns for the different types of vehicles involved in the accidents. Hence, I just added the vehicle type to the corresponding column names to get the following column names. After I was done with that, I saved the file as a csv so that I could easily import it into r. I then renamed them to be a little more usable

```{r}
type<-read.csv(file = 'Traffic2.csv')
colnames(type)
names(type)<-c("Year","Num_PV", "PV_per_100M", "PV_per_100k_RV","Num_LiT", "LiT_per_100M", "LiT_per_100k_RV","Num_LT", "LT_per_100M", "LT_per_100k_RV","Num_MC", "MC_per_100M", "MC_per_100k_RV")
colnames(type)
```

##### Data Exploration

So first I will look at the just the numbers of the different statistics across vehicle types.

```{r,echo=FALSE}
library(ggplot2)
ggplot(type,aes(Year,Num_PV))+geom_line(color='red')+labs(x="Year",y="Number of Accidents with a Passenger Car",title = "Number of Accidents by Vehicle Type")+
geom_line(aes(Year,Num_LiT),color='blue')+
geom_line(aes(Year,Num_LT),color='green')+
geom_line(aes(Year,Num_MC))+annotate("label", x=2012,y=25000,label="Passenger Cars")+annotate("label", x=2012,y=15000,label="Light Trucks")+annotate("label", x=2012,y=7500,label="Motorcycles")+annotate("label", x=2012,y=2000,label="Large Trucks")
```


```{r,echo=FALSE}
ggplot(type,aes(Year,PV_per_100M))+geom_line(color='red')+labs(x="Year",y="Number of Accidents with a Passenger Car",title = "Involvment rate per 100 million miles Traveled")+
geom_line(aes(Year,LiT_per_100M),color='blue')+
geom_line(aes(Year,LT_per_100M),color='green')+
geom_line(aes(Year,MC_per_100M))+annotate("label",x=2004,y=19,label="Motorcycles")

ggplot(type,aes(Year,PV_per_100M))+geom_line(color='red')+labs(x="Year",y="Number of Accidents with a Passenger Car",title = "Involvement rate per 100 million miles Traveled by Vehicle Type")+
geom_line(aes(Year,LiT_per_100M),color='blue')+
geom_line(aes(Year,LT_per_100M),color='green')+annotate("label",x=1995,y=2.75,label="Large Trucks")+annotate("label",x=1995,y=2.2,label="Light Trucks")+annotate("label",x=1996,y=1.75,label="Passenger Cars")

ggplot(type,aes(Year,PV_per_100_RV))+geom_line(color='red')+labs(x="Year",y="Number of Accidents with a Passenger Car",title = "Involvement rate per 100 thousand Registered Vehicles")+
geom_line(aes(Year,LiT_per_100_RV),color='blue')+
geom_line(aes(Year,LT_per_100_RV),color='green')+
geom_line(aes(Year,MC_per_100_RV))+annotate("Label",x=1995,y=75,label="Large Trucks")+annotate("Label",x=1995,y=50,label="Motorcycles")+annotate("Label",x=1995,y=32,label="Light Trucks")+annotate("Label",x=1996,y=20,label="Passenger Vehicles")

```


```{r}
Occupant<-read.csv("Traffic3.csv")
colnames(Occupant)
names(Occupant)<-c("Year","PV_Occupants", "LiT_Occupants", "LT_Occupants", "MC_Occupants", "Buses_Occupants", "Other", "Total")
colnames(Occupant)
```


```{r}
ggplot(Occupant,aes(Year,Total))+geom_line()+labs(x="Year",y="Accidents", title="Accidents by Year")
```


##### Conclusions

Looking at the above graphs, it appears that while there are fewer accidents including motorcycles by number. However when accounting for the smaller amount of motorcycles, it appears that they get into accidents at a higher rate. On the other side passenger vehicles have the most total number of accidents every year, however the involvement rate is consistently one of the lowest ones.

##### Challenges

With the format of the data I didn't forsee a way to easily add a legend so I added labels to differentiate and kept the same colors throughout in order to help avoid confusion.

##### Citations

https://stackoverflow.com/questions/44012554/r-how-can-i-annotate-a-ggplot-with-a-text-box/44012702

### Question 4

#### Who are the people(race, gender, age) who die in these accidents?

